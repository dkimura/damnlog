---
title: Netlify Lambda Functionã‚’è§¦ã£ãŸã‚ˆ
date: 2018/03/18
slug: 2018-03-18-til
---

### æ¦‚è¦

* Netlify Lambda?
  * `https://hogehoge.netlify.com/fuga` ã‚’å©ãã¨ä½•ã‹å‡¦ç†ã™ã‚‹ã‚‚ã®
  * https://functions-beta--www.netlify.com/docs/lambda-functions/
  * åŸºæœ¬çš„ã«ã¯ AWS Lambda ã¨åŒã˜ã‚‚ã®ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œãã†
* ã¾ã  Private Betaâ€¦ ğŸ˜‡
  * ç”³ã—è¾¼ã¿ã¯ Contact çµŒç”±ã ã£ãŸâ€¦
  * [`netlify-lambda`](https://github.com/netlify/netlify-lambda) ã¨ã„ã† npm ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ãˆã°ãƒ­ãƒ¼ã‚«ãƒ«ã§è©¦ã›ã‚‹

### ã‚„ã‚ŠãŸã„ã“ã¨

* Web ã§ä½œã‚Œã‚‹å±¥æ­´æ›¸ãƒ„ãƒ¼ãƒ«ã¿ãŸã„ãªã®ã‚’ä½œã‚ã†ã¨ã—ã¦ã„ã‚‹
* POST ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ã€React ã§ SSR ã—ã¦ HTML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã›ãŸã„
* with [styled-components](https://github.com/styled-components/styled-components) (CSS in JS)

### ã§ããŸ

```js
import React from 'react'
import { renderToStaticMarkup } from 'react-dom/server'
import styled, { ServerStyleSheet } from 'styled-components'

import Html from './components/Html'

const Comp = styled.h1`
  color: red;
`

export const handler = (event, context, callback) => {
  const sheet = new ServerStyleSheet()
  const body = renderToStaticMarkup(
    <Html
      markup={renderToStaticMarkup(sheet.collectStyles(<Comp>Hello</Comp>))}
      sheet={sheet}
      title={'Monthly Report'}
    />,
  )

  callback(null, {
    statusCode: 200,
    headers: {
      'Content-type': 'application/octet-stream',
      'Content-disposition': 'attachment; filename=index.html',
    },
    body,
  })
}
```

### å›°ã£ã¦ã„ã‚‹ã“ã¨

* `netlify-lambda` ãŒ Babel ç’°å¢ƒå‰æâ€¦ ğŸ˜‡
  * ã€Œwebpack.config ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã›ã¦ãã‚Œã€ã¨ã„ã†[issue](https://github.com/netlify/netlify-lambda/issues/6)ã¯æ—¢ã«ã‚ã‚‹
* ä»Šå›ã¯é¢å€’ãªã®ã§ã€Babel ã§æ›¸ã„ãŸ
  * ãŒã€æœ¬ä½“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ TypeScript ã§æ›¸ã„ã¦ã„ã‚‹ã®ã§ã€ã©ã†ã—ã‚ˆã†ã‹ãªâ€¦
